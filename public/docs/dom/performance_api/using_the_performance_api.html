<h1>Using the Performance API</h1> <p>A fundamental requirement of web performance is a precise and consistent definition of <em>time.</em> The <a href="../domhighrestimestamp"><code>DOMHighResTimeStamp</code></a> type (a <code>double</code>) is used by all performance interfaces to hold such time values. Additionally, there must be a way to create a <em>timestamp</em> for a specific point in time; this is done with the <a href="../performance/now"><code>now()</code></a> method.</p> <p>Web performance interfaces are defined in a <a href="https://www.w3.org/wiki/Web_Performance/Publications" rel=" noopener">suite of standards</a>. The <em>base</em> interface for these standards is the <a href="../performance"><code>Performance</code></a> interface and its methods and properties are extended by different standards. This guide describes how to use the <a href="../performance"><code>Performance</code></a> interfaces that are defined in the <a href="https://w3c.github.io/hr-time/" rel=" noopener">High-Resolution Time</a> standard. Other web performance guides (listed in the <a href="#see_also">See also</a> section) describe how to use additional methods and properties of the <a href="../performance"><code>Performance</code></a> interface.</p>
<h2 id="high_precision_timing">High precision timing</h2>
<p><em>High precision timing</em> is achieved by using the <a href="../domhighrestimestamp"><code>DOMHighResTimeStamp</code></a> type for time values. The unit is milliseconds and should be accurate to 5 Âµs (microseconds). However, if the browser is unable to provide a time value accurate to 5 microseconds (because of hardware or software constraints, for example), the browser can represent the value as a time in milliseconds accurate to a millisecond.</p> <p>The following code example shows the use of <a href="../domhighrestimestamp"><code>DOMHighResTimeStamp</code></a> and the <a href="../performance/now"><code>Performance.now()</code></a> method. The <a href="../performance/now"><code>now()</code></a> method returns a <em>timestamp</em> (of type <a href="../domhighrestimestamp"><code>DOMHighResTimeStamp</code></a>) that is a discrete point in time. By calling this method before and after a task, the time it takes to do the task can be measured.</p> <pre data-language="js"><span class="token keyword">function</span> <span class="token function">calculate_time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> startTime<span class="token punctuation">;</span>
  <span class="token keyword">var</span> endTime<span class="token punctuation">;</span>

  startTime <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">do_task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  endTime <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>endTime <span class="token operator">-</span> startTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
<h2 id="serializing_the_performance_object">Serializing the <code>Performance</code> object</h2>
<p>JSON serialization of the <a href="../performance"><code>Performance</code></a> object is done via the <a href="../performance/tojson"><code>toJSON()</code></a> method. In the following example, JSON serialization for the <a href="../performance"><code>Performance</code></a>, <a href="../performance/timing"><code>Performance.timing</code></a> and <a href="../performance/navigation"><code>Performance.navigation</code></a> objects is printed in the <code>object</code> element.</p> <pre data-language="js"><span class="token keyword">function</span> <span class="token function">print_json</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> json<span class="token punctuation">;</span>
  <span class="token keyword">var</span> o <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"output"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>performance<span class="token punctuation">.</span>toJSON <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    json <span class="token operator">=</span> <span class="token string">"window.performance.toJSON() is NOT supported"</span><span class="token punctuation">;</span>
    o<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> json <span class="token operator">+</span> <span class="token string">"&lt;br&gt;"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> s<span class="token punctuation">;</span>
    json <span class="token operator">=</span> window<span class="token punctuation">.</span>performance<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Print the performance object</span>
    s <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
    o<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"&lt;p&gt;performance = "</span> <span class="token operator">+</span> s <span class="token operator">+</span> <span class="token string">"&lt;/p&gt;"</span><span class="token punctuation">;</span>

    <span class="token comment">// Print the performance.timing and performance.navigation objects</span>
    <span class="token keyword">var</span> perf <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> timing <span class="token operator">=</span> perf<span class="token punctuation">.</span>timing<span class="token punctuation">;</span>
    o<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> <span class="token string">"&lt;p&gt;peformance.timing = "</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>timing<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&lt;/p&gt;"</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> navigation <span class="token operator">=</span> perf<span class="token punctuation">.</span>navigation<span class="token punctuation">;</span>
    o<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> <span class="token string">"&lt;p&gt;peformance.navigation = "</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>navigation<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&lt;/p&gt;"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre>
<h2 id="specifications">Specifications</h2>
<p>The interfaces described in this document are defined in the <code>High Resolution Time</code> standard which has two levels:</p> <ul> <li>
<a href="https://w3c.github.io/hr-time/" rel=" noopener">High-Resolution Time Level 2</a>; Editors Draft; Work In Progress</li> <li>
<a href="https://www.w3.org/TR/hr-time/" rel=" noopener">High-Resolution Time</a>; W3C Recommendation 17 December 2012</li> </ul>
<h2 id="interoperability">Interoperability</h2>
<p>As shown in the <a href="../performance"><code>Performance</code></a> interface's <a href="../performance#browser_compatibility">Browser Compatibility</a> table, most of the <a href="../performance"><code>Performance</code></a> interfaces are broadly implemented by desktop browsers.</p>
<h2 id="see_also">See also</h2>
<ul> <li><a href="../performance_api"><code>Performance API Overview</code></a></li> <li><a href="https://siusin.github.io/perf-timing-primer/" rel=" noopener">A Primer for Web Performance Timing APIs</a></li> <li><a href="https://docs.google.com/document/d/1ZKW9N0cteHgK91SyYQONFuy2ZW6J4Oak398niTo232E/edit" rel=" noopener">Graphic of Web Performance Layers</a></li> <li><a href="https://caniuse.com/#search=high-resolution-time" rel=" noopener">CanIUse data for High-Resolution Time</a></li> <li><a href="https://www.w3.org/wiki/Web_Performance/Publications" rel=" noopener">Web Performance Standards Status and Roadmap</a></li> </ul>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/Performance_API/Using_the_Performance_API" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/Performance_API/Using_the_Performance_API</a>
  </p>
</div>
