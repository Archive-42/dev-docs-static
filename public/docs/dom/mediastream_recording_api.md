# MediaStream Recording API

The **MediaStream Recording API**, sometimes referred to as the _Media Recording API_ or the _MediaRecorder API_, is closely affiliated with the [Media Capture and Streams API](media_streams_api) and the [WebRTC API](webrtc_api). The MediaStream Recording API makes it possible to capture the data generated by a [`MediaStream`](mediastream) or [`HTMLMediaElement`](htmlmediaelement) object for analysis, processing, or saving to disk. It's also surprisingly easy to work with.

## Basic concepts

The MediaStream Recording API is comprised of a single major interface, [`MediaRecorder`](mediarecorder), which does all the work of taking the data from a [`MediaStream`](mediastream) and delivering it to you for processing. The data is delivered by a series of `dataavailable` events, already in the format you specify when creating the `MediaRecorder`. You can then process the data further or write it to file as desired.

### Overview of the recording process

The process of recording a stream is simple:

1.  Set up a [`MediaStream`](mediastream) or [`HTMLMediaElement`](htmlmediaelement) (in the form of an [`<audio>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/audio) or [`<video>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video) element) to serve as the source of the media data.
2.  Create a [`MediaRecorder`](mediarecorder) object, specifying the source stream and any desired options (such as the container's MIME type or the desired bit rates of its tracks).
3.  Set [`MediaRecorder.ondataavailable`](mediarecorder/ondataavailable) to an event handler for the `dataavailable` event; this will be called whenever data is available for you.
4.  Once the source media is playing and you've reached the point where you're ready to record video, call [`MediaRecorder.start()`](mediarecorder/start) to begin recording.
5.  Your `dataavailable` event handler gets called every time there's data ready for you to do with as you will; the event has a `data` attribute whose value is a [`Blob`](blob) that contains the media data. You can force a `dataavailable` event to occur, thereby delivering the latest sound to you so you can filter it, save it, or whatever.
6.  Recording stops automatically when the source media stops playing.
7.  You can stop recording at any time by calling [`MediaRecorder.stop()`](mediarecorder/stop).

**Note:** Individual [`Blob`](blob)s containing slices of the recorded media will not necessarily be individually playable. The media needs to be reassembled before playback.

If anything goes wrong during recording, an `error` event is sent to the `MediaRecorder`. You can listen for `error` events by setting up a [`onerror`](mediarecorder/onerror) event handler.

Example here, we use an HTML Canvas as source of the [`MediaStream`](mediastream), and stop recording after 9 seconds.

    var canvas = document.querySelector("canvas");

    // Optional frames per second argument.
    var stream = canvas.captureStream(25);
    var recordedChunks = [];

    console.log(stream);
    var options = { mimeType: "video/webm; codecs=vp9" };
    mediaRecorder = new MediaRecorder(stream, options);

    mediaRecorder.ondataavailable = handleDataAvailable;
    mediaRecorder.start();

    function handleDataAvailable(event) {
      console.log("data-available");
      if (event.data.size > 0) {
        recordedChunks.push(event.data);
        console.log(recordedChunks);
        download();
      } else {
        // ...
      }
    }
    function download() {
      var blob = new Blob(recordedChunks, {
        type: "video/webm"
      });
      var url = URL.createObjectURL(blob);
      var a = document.createElement("a");
      document.body.appendChild(a);
      a.style = "display: none";
      a.href = url;
      a.download = "test.webm";
      a.click();
      window.URL.revokeObjectURL(url);
    }

    // demo: to download after 9sec
    setTimeout(event => {
      console.log("stopping");
      mediaRecorder.stop();
    }, 9000);

### Examining and controlling the recorder status

You can also use the properties of the `MediaRecorder` object to determine the state of the recording process, and its [`pause()`](mediarecorder/pause) and [`resume()`](mediarecorder/resume) methods to pause and resume recording of the source media.

If you need or want to check to see if a specific MIME type is supported, that's possible as well. Just call [`MediaRecorder.isTypeSupported()`](mediarecorder/istypesupported).

### Examining potential input sources

If your goal is to record camera and/or microphone input, you may wish to examine the available input devices before beginning the process of constructing the `MediaRecorder`. To do so, you'll need to call [`navigator.mediaDevices.enumerateDevices()`](mediadevices/enumeratedevices) to get a list of the available media devices. You can then examine that list and identify the potential input sources, and even filter the list based on desired criteria.

In this code snippet, `enumerateDevices()` is used to examine the available input devices, locate those which are audio input devices, and create [`<option>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/option) elements that are then added to a [`<select>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select) element representing an input source picker.

    navigator.mediaDevices.enumerateDevices()
    .then(function(devices) {
      devices.forEach(function(device) {
        let menu = document.getElementById("inputdevices");
        if (device.kind == "audioinput") {
          let item = document.createElement("option");
          item.innerText = device.label;
          item.value = device.deviceId;
          menu.appendChild(item);
        }
      });
    });

Code similar to this can be used to let the user restrict the set of devices they wish to use.

### For more information

To learn more about using the MediaStream Recording API, see [Using the MediaStream Recording API](mediastream_recording_api/using_the_mediastream_recording_api), which shows how to use the API to record audio clips. A second article, [Recording a media element](mediastream_recording_api/recording_a_media_element), describes how to receive a stream from an [`<audio>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/audio) or [`<video>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video) element and use the captured stream (in this case, recording it and saving it to a local disk).

## Reference

[`BlobEvent`](blobevent)  
Each time a chunk of media data is finished being recorded, it's delivered to consumers in [`Blob`](blob) form using a [`BlobEvent`](blobevent) of type `dataavailable`.

[`MediaRecorder`](mediarecorder)  
The primary interface that implements the MediaStream Recording API.

[`MediaRecorderErrorEvent`](mediarecordererrorevent)  
The interface that represents errors thrown by the MediaStream Recording API. Its [`error`](mediarecordererrorevent/error) property is a [`DOMException`](domexception) that specifies that error occurred.

## Specifications

<table><thead><tr class="header"><th>Specification</th><th>Status</th><th>Comment</th></tr></thead><tbody><tr class="odd"><td><a href="https://w3c.github.io/mediacapture-record/#MediaRecorderAPI">MediaStream Recording</a></td><td><span class="spec-wd">Working Draft</span></td><td>Initial definition</td></tr></tbody></table>

## Browser compatibility

Desktop

Mobile

Chrome

Edge

Firefox

Internet Explorer

Opera

Safari

WebView Android

Chrome Android

Firefox for Android

Opera Android

Safari on IOS

Samsung Internet

`MediaStream_Recording_API`

47

79

25

Prior to Firefox 58, using `MediaStream.addTrack()` on a stream obtained using `getUserMedia()`, then attempting to record the resulting stream would result in only recording the original stream without the added tracks (severe bug).

No

36

14

47

47

25

Prior to Firefox 58, using `MediaStream.addTrack()` on a stream obtained using `getUserMedia()`, then attempting to record the resulting stream would result in only recording the original stream without the added tracks (severe bug).

36

14

5.0

`MediaRecorder`

47

79

25

No

36

14

47

47

25

36

14

5.0

`audioBitsPerSecond`

49

79

71

No

36

14.1

49

49

79

36

14.5

5.0

`error_event`

49

79

25

No

36

14

49

49

25

36

14

5.0

`ignoreMutedMedia`

49-57

No

No

No

36-44

No

49-57

49-57

No

36-44

No

5.0-7.0

`isTypeSupported`

47

79

25

No

36

14

47

47

25

36

14

5.0

`mimeType`

49

47-49

Prior to Chrome 49, only video is supported, not audio.

79

25

Starting with Firefox 71, the behavior of `mimeType` is more consistent. For example, it now returns the media type even after recording has stopped.

No

36

14

49

47-49

Prior to Chrome 49, only video is supported, not audio.

49

47-49

Prior to Chrome 49, only video is supported, not audio.

25

36

14

5.0

`ondataavailable`

49

79

25

No

36

14

49

49

25

36

14

5.0

`onerror`

49

79

25

No

36

14

49

49

25

36

14

5.0

`onpause`

49

79

65

No

36

14.1

49

49

65

36

14.5

5.0

`onresume`

49

79

65

No

36

14.1

49

49

65

36

14.5

5.0

`onstart`

49

79

25

No

36

14

49

49

25

36

14

5.0

`onstop`

49

79

25

No

36

14

49

49

25

36

14

5.0

`onwarning`

49

79

25-71

No

36

No

49

49

25

36

No

5.0

`pause`

49

79

25

No

36

14.1

49

49

25

36

14.5

5.0

`requestData`

49

79

25

No

36

14

49

49

25

36

14

5.0

`resume`

49

79

25

No

36

14.1

49

49

25

36

14.5

5.0

`start`

47

79

25

No

36

14

47

47

25

36

14

5.0

`state`

49

47-49

Prior to Chrome 49, only video is supported, not audio.

79

25

No

36

14

49

47-49

Prior to Chrome 49, only video is supported, not audio.

49

47-49

Prior to Chrome 49, only video is supported, not audio.

25

36

14

5.0

`stop`

49

79

25

No

36

14

49

49

25

36

14

5.0

`stream`

49

47-49

Prior to Chrome 49, only video is supported, not audio.

79

25

No

36

14

49

49

47-49

Prior to Chrome 49, only video is supported, not audio.

25

36

14

5.0

`videoBitsPerSecond`

49

79

71

No

36

14.1

49

49

79

36

14.5

5.0

`warning_event`

49

79

25-71

No

36

No

49

49

25

36

No

5.0

BCD tables only load in the browser

## See also

- [Using the MediaStream Recording API](mediastream_recording_api/using_the_mediastream_recording_api)
- [Recording a media element](mediastream_recording_api/recording_a_media_element)
- [simpl.info MediaStream Recording demo](https://simpl.info/mediarecorder/), by [Sam Dutton](https://twitter.com/sw12)
- [`MediaDevices.getUserMedia`](mediadevices/getusermedia)
- [HTML5’s Media Recorder API in Action on Chrome and Firefox](https://addpipe.com/blog/mediarecorder-api/)
- [MediaRecorder polyfill](https://github.com/ai/audio-recorder-polyfill) for Safari and Edge
- [TutorRoom](https://github.com/chrisjohndigital/TutorRoom): HTML5 video capture/playback/download using getUserMedia and the MediaRecorder API ([source on GitHub](https://github.com/chrisjohndigital/TutorRoom))
- [Simple video recording demo](https://codepen.io/anon/pen/gpmPzm)
- [Advanced media stream recorder sample](https://quickblox.github.io/javascript-media-recorder/sample/)
- [OpenLang](https://github.com/chrisjohndigital/OpenLang): HTML5 video language lab web application using MediaDevices and the MediaStream Recording API for video recording ([source on GitHub](https://github.com/chrisjohndigital/OpenLang))
- [MediaStream Recorder API Now Available in Safari Technology Preview 73](https://addpipe.com/blog/safari-technology-preview-73-adds-limited-mediastream-recorder-api-support/)

<a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStream_Recording_API" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/MediaStream_Recording_API</a>
