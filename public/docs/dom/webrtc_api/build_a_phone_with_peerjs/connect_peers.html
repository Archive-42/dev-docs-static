<h1>Connecting the peers</h1>

 <ul class="prev-next"> <li><a class="button minimal" href="build_the_server"> Previous </a></li> <li><a class="button minimal" href="connect_peers/get_microphone_permission"> Next </a></li> </ul> <p>In the last article we set up our server, but it doesn't do anything yet because we are not serving anything. This is the part you've been waiting for — actually creating the client-side peer connection and call logic. This is going to be an involved process, but we've split it into numerous subsections so you can tackle the different aprts in easy bite-sized chunks.</p> <ol> <li> <p>First up, create a <code>script.js</code> file in the same location as the others — this is where all your logic will live.</p> </li> <li> <p>We need to create a peer object with an ID. The ID will be used to connect two peers together and if you don’t create one, one will be assigned to the peer. Add the following to <code>script.js</code>:</p> <pre data-language="js"><span class="token keyword">const</span> peer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Peer</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token operator">+</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    host<span class="token operator">:</span> location<span class="token punctuation">.</span>hostname<span class="token punctuation">,</span>
    debug<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> <span class="token string">'/myapp'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre> </li> <li> <p>You'll then need to attach the peer to the window so that it's accessible. Add the following line below your previous code:</p> <pre data-language="js">window<span class="token punctuation">.</span>peer <span class="token operator">=</span> peer<span class="token punctuation">;</span></pre> </li> <li> <p>In another terminal window, start the peer server by running the following command inside the root of your phone app directory:</p> <pre data-language="bash">peerjs --port <span class="token number">443</span> --key peerjs --path /myapp</pre> </li> </ol> <p>This looks very similar to the peer server we created in the last step; this is the client-side portion. In order for the browser to connect to the running peer server, we need to tell it how; this is what the above line does. </p> <ul class="prev-next"> <li><a class="button minimal" href="build_the_server"> Previous </a></li> <li><a class="button minimal" href="connect_peers/get_microphone_permission"> Next </a></li> </ul>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API/Build_a_phone_with_peerjs/Connect_peers" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API/Build_a_phone_with_peerjs/Connect_peers</a>
  </p>
</div>
