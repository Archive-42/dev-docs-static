<h1>WindowOrWorkerGlobalScope.setTimeout()</h1> <p>The <code>setTimeout()</code> method of the <a href="../windoworworkerglobalscope"><code>WindowOrWorkerGlobalScope</code></a> <a href="https://developer.mozilla.org/en-US/docs/Glossary/Mixin">mixin</a> (and successor to <code>Window.setTimeout()</code>) sets a timer which executes a function or specified piece of code once the timer expires.</p>
<h2 id="syntax">Syntax</h2>
<pre data-language="js"><span class="token keyword">var</span> timeoutID <span class="token operator">=</span> scope<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">[</span><span class="token punctuation">,</span> delay<span class="token punctuation">,</span> arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> timeoutID <span class="token operator">=</span> scope<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">[</span><span class="token punctuation">,</span> delay<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> timeoutID <span class="token operator">=</span> scope<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>code<span class="token punctuation">[</span><span class="token punctuation">,</span> delay<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<h3 id="parameters">Parameters</h3>
<dl> <dt><code><var>function</var></code></dt> <dd>A <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function"><code>function</code></a> to be executed after the timer expires.</dd> <dt><code><var>code</var></code></dt> <dd>An alternative syntax that allows you to include a string instead of a function, which is compiled and executed when the timer expires. This syntax is <strong>not recommended</strong> for the same reasons that make using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval"><code>eval()</code></a> a security risk.</dd> <dt>
<code><var>delay</var></code> <span class="badge inline optional">Optional</span>
</dt> <dd>The time, in milliseconds (thousandths of a second), the timer should wait before the specified function or code is executed. If this parameter is omitted, a value of 0 is used, meaning execute "immediately", or more accurately, the next event cycle. Note that in either case, the actual delay may be longer than intended; see <a href="#reasons_for_delays_longer_than_specified">Reasons for delays longer than specified</a> below.</dd> <dt>
<code><var>arg1</var>, ..., <var>argN</var></code> <span class="badge inline optional">Optional</span>
</dt> <dd>Additional arguments which are passed through to the function specified by <code><var>function</var></code>.</dd> </dl> <div class="note notecard"> <p><strong>Note</strong>: Passing additional parameters to the function in the first syntax does not work in Internet Explorer 9 and below. If you want to enable this functionality on that browser, you must use a polyfill (see the <a href="#polyfill">Polyfill</a> section).</p> </div>
<h3 id="return_value">Return value</h3>
<p>The returned <code><var>timeoutID</var></code> is a positive integer value which identifies the timer created by the call to <code>setTimeout()</code>; this value can be passed to <a href="cleartimeout"><code>clearTimeout()</code></a> to cancel the timeout.</p> <p>It may be helpful to be aware that <code>setTimeout()</code> and <a href="setinterval"><code>setInterval()</code></a> share the same pool of IDs, and that <code>clearTimeout()</code> and <a href="clearinterval"><code>clearInterval()</code></a> can technically be used interchangeably. For clarity, however, you should try to always match them to avoid confusion when maintaining your code.</p> <p>It is guaranteed that a timeout ID will never be reused by a subsequent call to <code>setTimeout()</code> or <code>setInterval()</code> on the same object (a window or a worker). However, different objects use separate pools of IDs.</p>
<h2 id="example">Examples</h2>
<h2 id="timeouts">1: setTimeout() / clearTimeout()</h2>
<p>The following example sets up two simple buttons in a web page and hooks them to the <code>setTimeout()</code> and <code>clearTimeout()</code> routines. Pressing the first button will set a timeout which calls an alert dialog after two seconds and stores the timeout id for use by <code>clearTimeout()</code>. You may optionally cancel this timeout by pressing on the second button.</p>
<h3 id="html">HTML</h3>
<pre data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Live Example<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>delayedAlert();<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Show an alert box after two seconds<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clearAlert();<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Cancel alert before it happens<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</pre>
<h3 id="javascript">JavaScript</h3>
<pre data-language="js"><span class="token keyword">var</span> timeoutID<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">delayedAlert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  timeoutID <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>alert<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token string">'That was really slow!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">clearAlert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  window<span class="token punctuation">.</span><span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutID<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
<h3 id="result">Result</h3>
<p><iframe class="sample-code-frame" id="frame_Timeouts" src="https://yari-demos.prod.mdn.mozit.cloud/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout/_samples_/Timeouts" loading="lazy"></iframe></p> <p>See also <a href="cleartimeout#example"><code>clearTimeout()</code> example</a>.</p>
<h2 id="timeouts_throttled">2: Timeouts throttled</h2>
<p>This example defines functions which demonstrate this throttling effect:</p> <ul> <li>
<em><code>interval()</code></em>, called after <code><a href="setinterval"><code>setInterval()</code></a></code> interval expiration.</li> <li>
<em><code>timeout()</code></em> called after <code><a href="settimeout"><code>setTimeout()</code></a></code> timer expiration.</li> <li>
<em><code>run()</code></em>, called at program start.</li> <li>
<em><code>logline()</code></em>, called at interval and timer expiration, displays the last and current intervals along with an indicator when throttling occurs.</li>
</ul> <p>The durations defined for <code>interval()</code> and <code>timeout()</code> cause both timers to immediately expire which triggers their completion functions. The browser applies call throttling when it senses that it's calling these completion functions in rapid succession.</p>
<h3 id="html2">HTML</h3>
<pre data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Live Example<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>run();<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Run<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</pre>
<h3 id="javascript2">JavaScript</h3>
<pre data-language="js"><span class="token keyword">var</span> to_timer <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// duration is zero milliseconds</span>
<span class="token keyword">var</span> interval_timer <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// expires immediately</span>
<span class="token keyword">var</span> cleanup_timer <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// fires at end of run</span>
<span class="token keyword">var</span> last <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// last millisecond recorded</span>
<span class="token keyword">var</span> duration <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span> <span class="token comment">// run duration in milliseconds</span>
<span class="token keyword">var</span> lineno <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// current output line number</span>

<span class="token keyword">function</span> <span class="token function">interval</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">logline</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getMilliseconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">timeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">logline</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getMilliseconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">interval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  to_timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>timeout<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  interval_timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span>interval<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  to_timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>timeout<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  cleanup_timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span>cleanup<span class="token punctuation">,</span> duration<span class="token punctuation">)</span><span class="token punctuation">;</span>
  last <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  lineno <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"log"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"log"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"line last current"</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">logline</span><span class="token punctuation">(</span><span class="token parameter">msec</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// msec can't wrap: run duration &gt; 1 second</span>
  <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>last <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>last <span class="token operator">&gt;</span> msec <span class="token operator">-</span> <span class="token number">1</span> <span class="token comment">/* variation */</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> c <span class="token operator">=</span> <span class="token string">"Throttled"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"log"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span>  <span class="token string">"&lt;pre&gt;"</span> <span class="token operator">+</span> <span class="token function">pad</span><span class="token punctuation">(</span>lineno<span class="token operator">++</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"  "</span> <span class="token operator">+</span> <span class="token function">pad</span><span class="token punctuation">(</span>last<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"  "</span> <span class="token operator">+</span> msec <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> c<span class="token punctuation">;</span>
  last <span class="token operator">=</span> msec<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
<h3 id="result2">Result</h3>
<p><iframe class="sample-code-frame" id="frame_Timeouts_throttled" width="100" height="175" src="https://yari-demos.prod.mdn.mozit.cloud/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout/_samples_/Timeouts_throttled" loading="lazy"></iframe></p>
<h2 id="polyfill">Polyfill</h2>
<p>If you need to pass one or more arguments to your callback function, but need it to work in browsers which don't support sending additional arguments using either <code>setTimeout()</code> or <code>setInterval()</code> (e.g., Internet Explorer 9 and below), you can include this polyfill to enable the HTML5 standard arguments-passing functionality. Just add this code to the top of your script:</p> <pre data-language="js"><span class="token comment">/*\
|*|
|*|  Polyfill which enables the passage of arbitrary arguments to the
|*|  callback functions of JavaScript timers (HTML5 standard syntax).
|*|
|*|  https://developer.mozilla.org/en-US/docs/DOM/window.setInterval
|*|
|*|  Syntax:
|*|  var timeoutID = window.setTimeout(func, delay[, arg1, arg2, ...]);
|*|  var timeoutID = window.setTimeout(code, delay);
|*|  var intervalID = window.setInterval(func, delay[, arg1, arg2, ...]);
|*|  var intervalID = window.setInterval(code, delay);
|*|
\*/</span>

<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">arg1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>arg1 <span class="token operator">===</span> <span class="token string">'test'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// feature test is passed, no need for polyfill</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> __nativeST__ <span class="token operator">=</span> window<span class="token punctuation">.</span>setTimeout<span class="token punctuation">;</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">setTimeout</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>vCallback<span class="token punctuation">,</span> nDelay <span class="token comment">/*, argumentToPass1, argumentToPass2, etc. */</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> aArgs <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">__nativeST__</span><span class="token punctuation">(</span>vCallback <span class="token keyword">instanceof</span> <span class="token class-name">Function</span> <span class="token operator">?</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">vCallback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> aArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token operator">:</span> vCallback<span class="token punctuation">,</span> nDelay<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> interval <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">arg1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span>interval<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>arg1 <span class="token operator">===</span> <span class="token string">'test'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// feature test is passed, no need for polyfill</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> __nativeSI__ <span class="token operator">=</span> window<span class="token punctuation">.</span>setInterval<span class="token punctuation">;</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">setInterval</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>vCallback<span class="token punctuation">,</span> nDelay <span class="token comment">/*, argumentToPass1, argumentToPass2, etc. */</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> aArgs <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">__nativeSI__</span><span class="token punctuation">(</span>vCallback <span class="token keyword">instanceof</span> <span class="token class-name">Function</span> <span class="token operator">?</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">vCallback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> aArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token operator">:</span> vCallback<span class="token punctuation">,</span> nDelay<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre>
<h3 id="ie-only_fix">IE-only fix</h3>
<p>If you want a completely unobtrusive fix for every other mobile or desktop browser, including IE 9 and below, you can either use JavaScript conditional comments:</p> <pre data-language="js"><span class="token comment">/*@cc_on
  // conditional IE &lt; 9 only fix
  @if (@_jscript_version &lt;= 9)
  (function(f){
     window.setTimeout = f(window.setTimeout);
     window.setInterval = f(window.setInterval);
  })(function(f){return function(c,t){var a=[].slice.call(arguments,2);return f(function(){c instanceof Function?c.apply(this,a):eval(c)},t)}});
  @end
@*/</span>
</pre> <p>... or go for a very clean approach based on the IE HTML conditional feature:</p> <pre data-language="html"><span class="token comment">&lt;!--[if lte IE 9]&gt;&lt;script&gt;
(function(f){
window.setTimeout=f(window.setTimeout);
window.setInterval=f(window.setInterval);
})(function(f){return function(c,t){
var a=[].slice.call(arguments,2);return f(function(){c instanceof Function?c.apply(this,a):eval(c)},t)}
});
&lt;/script&gt;&lt;![endif]--&gt;</span>
</pre>
<h3 id="workarounds">Workarounds</h3>
<p>Another possibility is to use an anonymous function to call your callback, but this solution is a bit more expensive. Example:</p> <pre data-language="js"><span class="token keyword">var</span> intervalID <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">myFunc</span><span class="token punctuation">(</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre> <p>The above example can also be written with the help of an <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions"> arrow function</a>:</p> <pre data-language="js"><span class="token keyword">var</span> intervalID <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">myFunc</span><span class="token punctuation">(</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre> <p>Yet another possibility is to use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind">function's <code>bind</code></a>. Example:</p> <pre data-language="js"><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">arg1</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<h2 id="the_this_problem">The "this" problem</h2>
<p>When you pass a method to <code>setTimeout()</code> (or any other function, for that matter), it will be invoked with a <code>this</code> value that may differ from your expectation. This issue is explained in detail in the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this#as_an_object_method">JavaScript reference</a>.</p>
<h3 id="explanation">Explanation</h3>
<p>Code executed by <code>setTimeout()</code> is called from an execution context separate from the function from which <code>setTimeout</code> was called. The usual rules for setting the <code>this</code> keyword for the called function apply, and if you have not set <code>this</code> in the call or with <code>bind</code>, it will default to the <code>window</code> (or <code>global</code>) object. It will not be the same as the <code>this</code> value for the function that called <code>setTimeout</code>.</p> <p>See the following example:</p> <pre data-language="js">myArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'zero'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
myArray<span class="token punctuation">.</span><span class="token function-variable function">myMethod</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">sProperty</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">[</span>sProperty<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

myArray<span class="token punctuation">.</span><span class="token function">myMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints "zero,one,two"</span>
myArray<span class="token punctuation">.</span><span class="token function">myMethod</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints "one"</span></pre> <p>The above works because when <code>myMethod</code> is called, its <code>this</code> is set to <code>myArray</code> by the call, so within the function, <code>this[sProperty]</code> is equivalent to <code>myArray[sProperty]</code>. However, in the following:</p> <pre data-language="js"><span class="token function">setTimeout</span><span class="token punctuation">(</span>myArray<span class="token punctuation">.</span>myMethod<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints "[object Window]" after 1 second</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span>myArray<span class="token punctuation">.</span>myMethod<span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints "undefined" after 1.5 seconds</span></pre> <p>The <code>myArray.myMethod</code> function is passed to <code>setTimeout</code>, then when it's called, its <code>this</code> is not set so it defaults to the <code>window</code> object. There's also no option to pass a <code>thisArg</code> to setTimeout as there is in Array methods like forEach, reduce, etc. and as shown below, using <code>call</code> to set <code>this</code> doesn't work either.</p> <pre data-language="js"><span class="token function">setTimeout</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>myArray<span class="token punctuation">,</span> myArray<span class="token punctuation">.</span>myMethod<span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error: "NS_ERROR_XPC_BAD_OP_ON_WN_PROTO: Illegal operation on WrappedNative prototype object"</span>
<span class="token function">setTimeout</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>myArray<span class="token punctuation">,</span> myArray<span class="token punctuation">.</span>myMethod<span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// same error</span>
</pre>
<h3 id="possible_solutions">Possible solutions</h3>
<p>A common way to solve the problem is to use a wrapper function that sets <code>this</code> to the required value:</p> <pre data-language="js"><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>myArray<span class="token punctuation">.</span><span class="token function">myMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints "zero,one,two" after 2 seconds</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>myArray<span class="token punctuation">.</span><span class="token function">myMethod</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints "one" after 2.5 seconds</span></pre> <p>Arrow functions are a possible alternative, too:</p> <pre data-language="js"><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>myArray<span class="token punctuation">.</span><span class="token function">myMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints "zero,one,two" after 2 seconds</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>myArray<span class="token punctuation">.</span><span class="token function">myMethod</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints "one" after 2.5 seconds</span></pre> <p>Another possible way to solve the "<code>this</code>" problem is to replace the host <code>setTimeout()</code> and <code>setInterval()</code> global functions with ones that allow passing a <code>this</code> object and set it in the callback using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call"><code>Function.prototype.call</code></a>, e.g.:</p> <pre data-language="js"><span class="token comment">// Enable setting 'this' in JavaScript timers</span>

<span class="token keyword">var</span> __nativeST__ <span class="token operator">=</span> window<span class="token punctuation">.</span>setTimeout<span class="token punctuation">,</span>
    __nativeSI__ <span class="token operator">=</span> window<span class="token punctuation">.</span>setInterval<span class="token punctuation">;</span>

window<span class="token punctuation">.</span><span class="token function-variable function">setTimeout</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>vCallback<span class="token punctuation">,</span> nDelay <span class="token comment">/*, argumentToPass1, argumentToPass2, etc. */</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> oThis <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
      aArgs <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">__nativeST__</span><span class="token punctuation">(</span>vCallback <span class="token keyword">instanceof</span> <span class="token class-name">Function</span> <span class="token operator">?</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">vCallback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>oThis<span class="token punctuation">,</span> aArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token operator">:</span> vCallback<span class="token punctuation">,</span> nDelay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span><span class="token function-variable function">setInterval</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>vCallback<span class="token punctuation">,</span> nDelay <span class="token comment">/*, argumentToPass1, argumentToPass2, etc. */</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> oThis <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
      aArgs <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">__nativeSI__</span><span class="token punctuation">(</span>vCallback <span class="token keyword">instanceof</span> <span class="token class-name">Function</span> <span class="token operator">?</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">vCallback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>oThis<span class="token punctuation">,</span> aArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token operator">:</span> vCallback<span class="token punctuation">,</span> nDelay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></pre> <div class="note notecard">
<strong>Note</strong>: These two replacements will also enable the HTML5 standard passage of arbitrary arguments to the callback functions of timers in IE. So they can be used as polyfills also. See the <a href="#callback_arguments">Callback arguments</a> paragraph.</div> <p>New feature test:</p> <pre data-language="js">myArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'zero'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
myArray<span class="token punctuation">.</span><span class="token function-variable function">myMethod</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">sProperty</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">[</span>sProperty<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span>alert<span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">,</span> <span class="token string">'Hello world!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// the standard use of setTimeout and setInterval is preserved, but...</span>
<span class="token function">setTimeout</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>myArray<span class="token punctuation">,</span> myArray<span class="token punctuation">.</span>myMethod<span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints "zero,one,two" after 2 seconds</span>
<span class="token function">setTimeout</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>myArray<span class="token punctuation">,</span> myArray<span class="token punctuation">.</span>myMethod<span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints "two" after 2.5 seconds</span>
</pre> <div class="note notecard">
<strong>Note</strong>: JavaScript 1.8.5 introduced the <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind">Function.prototype.bind()</a></code> method to set the value of <code>this</code> for all calls to a given function. This can avoid having to use a wrapper function to set the value of <code>this</code> in a callback.</div> <p>Example using <code>bind()</code>:</p> <pre data-language="js">myArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'zero'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
myBoundMethod <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">sProperty</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">[</span>sProperty<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>myArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">myBoundMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints "zero,one,two" because 'this' is bound to myArray in the function</span>
<span class="token function">myBoundMethod</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints "one"</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span>myBoundMethod<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// still prints "zero,one,two" after 1 second because of the binding</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span>myBoundMethod<span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints "one" after 1.5 seconds</span>
</pre>
<h2 id="notes">Notes</h2>
<p>Timeouts are cancelled using <a href="cleartimeout"><code>clearTimeout()</code></a>.</p> <p>To call a function repeatedly (e.g., every N milliseconds), consider using <a href="setinterval"><code>setInterval()</code></a>.</p>
<h3 id="passing_string_literals">Passing string literals</h3>
<p>Passing a string instead of a function to <code>setTimeout()</code> has the same associated problems as using <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval#don.27t_use_eval.21">eval</a>. </code> </p> <pre data-language="js"><span class="token comment">// Recommended</span>
window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Hello World!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Not recommended</span>
window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">"alert('Hello World!');"</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre> <p>A string passed to <code><a href="settimeout"><code>setTimeout()</code></a></code> is evaluated in the global context, so local symbols in the context where <code><a href="settimeout"><code>setTimeout()</code></a></code> was called will not be available when the string is evaluated as code.</p>
<h3 id="reasons_for_delays">Reasons for delays longer than specified</h3>
<p>There are a number of reasons why a timeout may take longer to fire than anticipated. This section describes the most common reasons.</p> <h4 id="e_clampus_vitus">Clamping</h4> <p>In modern browsers, <code><a href="settimeout"><code>setTimeout()</code></a></code>/<a href="setinterval"><code>setInterval()</code></a> calls are throttled to a minimum of once every 4 ms when successive calls are triggered due to callback nesting (where the nesting level is at least a certain depth), or after certain number of successive intervals.</p> <p>See <a href="#2_timeouts_throttled">2 Timeouts throttled</a> example, above.</p> <div class="note notecard"> <p>In Chrome and Firefox, the 5th successive callback call is clamped; Safari clamps on the 6th call; in Edge it's the 3rd one. Gecko started to clamp after 4ms <code><a href="setinterval"><code>setInterval()</code></a></code> in <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases/56">version 56</a>. It already did this with <code>setTimeout()</code>, as described in the following notes.</p> </div> <div class="note notecard"> <p><a href="https://code.google.com/p/chromium/issues/detail?id=792#c10">Historically</a> some browsers implemented this throttling behavior a bit differently (e.g. Firefox) — on <code><a href="setinterval"><code>setInterval()</code></a></code> calls made from anywhere, or when a nested <code><a href="settimeout"><code>setTimeout()</code></a></code> is called where the nesting level is at least a certain depth.</p> </div> <div class="note notecard"> <p>To implement a 0 ms timeout in a modern browser, you can use <a href="../window/postmessage"><code>window.postMessage()</code></a> as <a href="https://dbaron.org/log/20100309-faster-timeouts">described here</a>.</p> </div> <div class="note notecard"> <p>The minimum delay, <code>DOM_MIN_TIMEOUT_VALUE</code>, is 4 ms (stored in a preference in Firefox: <code>dom.min_timeout_value</code>), with a <code>DOM_CLAMP_TIMEOUT_NESTING_LEVEL</code> of 5.</p> <p>4 ms is <a href="https://www.whatwg.org/specs/web-apps/current-work/multipage/timers.html#timers" rel=" noopener">specified by the HTML5 spec</a> and is consistent across browsers released in 2010 and onward. Prior to (Firefox 5.0 / Thunderbird 5.0 / SeaMonkey 2.2), the minimum timeout value for nested timeouts was 10 ms.</p> </div> <h4 id="timeouts_in_inactive_tabs_throttled_to_≥_1000ms">Timeouts in inactive tabs throttled to ≥ 1000ms</h4> <p>To reduce the load (and associated battery usage) from background tabs, timeouts are throttled to firing no more often than once per second (1,000 ms) in inactive tabs.</p> <p>Firefox implements this behavior since version 5 (see <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=633421" rel=" noopener">bug 633421</a>, the 1000ms constant can be tweaked through the <span class="comment-copy"><code>dom.min_background_timeout_value</code> preference).</span> Chrome implements this behavior since version 11 (<a href="https://crbug.com/66078" rel=" noopener">crbug.com/66078</a>).</p> <p>Firefox for Android uses a timeout value of 15 minutes for background tabs since <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=736602" rel=" noopener">bug 736602</a> in Firefox 14, and background tabs can also be unloaded entirely.</p> <div class="note notecard"> <p>Firefox 50 no longer throttles background tabs if a Web Audio API <a href="../audiocontext"><code>AudioContext</code></a> is actively playing sound. Firefox 51 further amends this such that background tabs are no longer throttled if an <a href="../audiocontext"><code>AudioContext</code></a> is present in the tab at all, even if no sound is being played. These resolve a number of issues with apps which play note-based music not being able to time or synchronize the music properly when the tab is in the background.</p> </div> <h4 id="throttling_of_tracking_timeout_scripts">Throttling of tracking timeout scripts </h4> <p>Since Firefox 55, tracking scripts (e.g. Google Analytics, any script URL that Firefox recognises as a tracking script through its <a href="https://wiki.mozilla.org/Security/Tracking_protection#Lists" rel=" noopener">TP lists</a>) have been subject to further throttling. When running in the foreground, the throttling minimum delay is still 4ms. In background tabs, however, the throttling minimum delay is 10,000 ms, or 10 seconds, which comes into effect 30 seconds after a document has first loaded.</p> <p>The prefs that control this behavior are:</p> <ul> <li>
<code>dom.min_tracking_timeout_value</code>: 4</li> <li>
<code>dom.min_tracking_background_timeout_value</code>: 10000</li> <li>
<code>dom.timeout.tracking_throttling_delay</code>: 30000</li> </ul> <h4 id="late_timeouts">Late timeouts</h4> <p>In addition to <a href="#clamping">Clamping</a>, the timeout can also fire later when the page (or the OS/browser itself) is busy with other tasks. One important case to note is that the function or code snippet cannot be executed until the thread that called <code><a href="settimeout"><code>setTimeout()</code></a></code> has terminated. For example:</p> <pre data-language="js"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'foo has been called'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'After setTimeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre> <p>Will write to the console:</p> <pre class="notranslate">After setTimeout
foo has been called</pre> <p>This is because even though <code>setTimeout</code> was called with a delay of zero, it's placed on a queue and scheduled to run at the next opportunity; not immediately. Currently-executing code must complete before functions on the queue are executed, thus the resulting execution order may not be as expected.</p> <h4 id="deferral_of_timeouts_during_pageload">Deferral of timeouts during pageload</h4> <p>Starting in Firefox 66, Firefox will defer firing setTimeout and setInterval timers while the current tab is loading. Firing is deferred until the MainThread is deemed idle (similar to <a href="../window/requestidlecallback">window.requestIdleCallback()</a>), or until the load event is fired.</p>
<h3 id="webextension_background_pages_and_timers">WebExtension background pages and timers </h3>
<p>In <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions">WebExtension</a> background pages, timers don't work properly. This is because background pages don't actually stay loaded all the time: the browser can unload them if they are not being used, and restore them when they are needed. This is mostly transparent to the extension, but some things (including JS timers) won't work across an unload/restore cycle, so background pages are encouraged instead to use alarms, which will work. There's some more detail on this at <a href="https://developer.chrome.com/extensions/background_migration" rel=" noopener">Migrate to Event Driven Background Scripts</a>.</p> <p>At the time of writing, only Chrome exhibited the above behavior — Firefox doesn't yet do the unload/restore behavior, so timers will work. But it's still a good idea to avoid timers in WebExtensions, for a couple of reasons:</p> <ol> <li>Compat with Chrome.</li> <li>Future changes in behavior that may cause problems.</li> </ol>
<h3 id="maximum_delay_value">Maximum delay value</h3>
<p>Browsers including Internet Explorer, Chrome, Safari, and Firefox store the delay as a 32-bit signed integer internally. This causes an integer overflow when using delays larger than 2,147,483,647 ms (about 24.8 days), resulting in the timeout being executed immediately.</p>
<h2 id="specifications">Specifications</h2>
<div class="_table"><table class="standard-table"> <thead> <tr> <th>Specification</th> <th>Status</th> <th>Comment</th> </tr> </thead> <tbody> <tr> <td><a href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-settimeout" hreflang="en" rel=" noopener">HTML Living Standard<br><small>The definition of 'WindowOrWorkerGlobalScope.setTimeout()' in that specification.</small></a></td> <td><span class="spec-living">Living Standard</span></td> <td>Method moved to the <code>WindowOrWorkerGlobalScope</code> mixin in the latest spec.</td> </tr> <tr> <td><a href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-settimeout" hreflang="en" rel=" noopener">HTML Living Standard<br><small>The definition of 'WindowTimers.setTimeout()' in that specification.</small></a></td> <td><span class="spec-living">Living Standard</span></td> <td>Initial definition (DOM Level 0)</td> </tr> </tbody> </table></div>
<h2 id="browser_compatibility">Browser compatibility</h2>
<table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="6">Desktop</th>
<th colspan="6">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
<th>WebView Android</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
</tr>
</thead>
<tbody>
<tr>
<th><code>setTimeout</code></th>
<td class="bc-supports-yes"><div>30</div></td>
<td class="bc-supports-yes"><div>12</div></td>
<td class="bc-supports-yes"><div>1</div></td>
<td class="bc-supports-yes"><div>4</div></td>
<td class="bc-supports-yes"><div>4</div></td>
<td class="bc-supports-yes"><div>1</div></td>
<td class="bc-supports-yes"><div>4.4</div></td>
<td class="bc-supports-yes"><div>30</div></td>
<td class="bc-supports-yes"><div>4</div></td>
<td class="bc-supports-yes"><div>10.1</div></td>
<td class="bc-supports-yes"><div>1</div></td>
<td class="bc-supports-yes"><div>3.0</div></td>
</tr>
<tr>
<th><code>supports_parameters_for_callback</code></th>
<td class="bc-supports-yes"><div>Yes</div></td>
<td class="bc-supports-yes"><div>12</div></td>
<td class="bc-supports-yes"><div>Yes</div></td>
<td class="bc-supports-yes"><div>10</div></td>
<td class="bc-supports-yes"><div>Yes</div></td>
<td class="bc-supports-yes"><div>?</div></td>
<td class="bc-supports-yes"><div>Yes</div></td>
<td class="bc-supports-yes"><div>Yes</div></td>
<td class="bc-supports-yes"><div>?</div></td>
<td class="bc-supports-yes"><div>?</div></td>
<td class="bc-supports-yes"><div>?</div></td>
<td class="bc-supports-yes"><div>Yes</div></td>
</tr>
<tr>
<th><code>tracking_throttling</code></th>
<td class="bc-supports-yes"><div>?</div></td>
<td class="bc-supports-yes"><div>?</div></td>
<td class="bc-supports-yes"><div>55</div></td>
<td class="bc-supports-yes"><div>?</div></td>
<td class="bc-supports-yes"><div>?</div></td>
<td class="bc-supports-yes"><div>?</div></td>
<td class="bc-supports-yes"><div>?</div></td>
<td class="bc-supports-yes"><div>?</div></td>
<td class="bc-supports-yes"><div>55</div></td>
<td class="bc-supports-yes"><div>?</div></td>
<td class="bc-supports-yes"><div>?</div></td>
<td class="bc-supports-yes"><div>?</div></td>
</tr>
</tbody>
</table>


<h2 id="see_also">See also</h2>
<ul> <li><a href="cleartimeout"><code>WindowOrWorkerGlobalScope.clearTimeout</code></a></li> <li><a href="setinterval"><code>WindowOrWorkerGlobalScope.setInterval</code></a></li> <li><a href="../window/requestanimationframe"><code>window.requestAnimationFrame</code></a></li> </ul>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout</a>
  </p>
</div>
