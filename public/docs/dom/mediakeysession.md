MediaKeySession
===============

The `MediaKeySession` interface of the [EncryptedMediaExtensions API](encrypted_media_extensions_api) represents a context for message exchange with a content decryption module (CDM).

Properties
----------

 [`MediaKeySession.closed`](mediakeysession/closed) <span class="badge inline readonly">Read only </span>   
Returns a [`Promise`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) signaling when a `MediaKeySession` closes. This promise can only be fulfilled and is never rejected. Closing a session means that licenses and keys associated with it are no longer valid for decrypting media data.

 [`MediaKeySession.expiration`](mediakeysession/expiration) <span class="badge inline readonly">Read only </span>   
The time after which the keys in the current session can no longer be used to decrypt media data, or `NaN` if no such time exists. This value is determined by the CDM and measured in milliseconds since January 1, 1970, UTC. This value may change during a session lifetime, such as when an action triggers the start of a window.

 [`MediaKeySession.keyStatuses`](mediakeysession/keystatuses) <span class="badge inline readonly">Read only </span>   
Contains a reference to a read-only [`MediaKeyStatusMap`](mediakeystatusmap) of the current session's keys and their statuses.

 [`MediaKeySession.sessionId`](mediakeysession/sessionid) <span class="badge inline readonly">Read only </span>   
Contains a unique string generated by the CDM for the current media object and its associated keys or licenses.

### Event handlers

[`MediaKeySession.onkeystatuseschange`](mediakeysession/onkeystatuseschange)  
Sets the [`EventHandler`](https://developer.mozilla.org/en-US/docs/Web/Events/Event_handlers) called when there has been a change in the keys in a session or their statuses.

[`MediaKeySession.onmessage`](mediakeysession/onmessage)  
Sets the [`EventHandler`](https://developer.mozilla.org/en-US/docs/Web/Events/Event_handlers) called when the content decryption module has generated a message for the session.

Methods
-------

[`MediaKeySession.close()`](mediakeysession/close)  
Returns a [`Promise`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) after notifying the current media session is no longer needed and that the CDM should release any resources associated with this object and close it.

[`MediaKeySession.generateRequest()`](mediakeysession/generaterequest)  
Returns a [`Promise`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) after generating a media request based on initialization data.

[`MediaKeySession.load()`](mediakeysession/load)  
Returns a [`Promise`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) that resolves to a boolean value after loading data for a specified session object.

[`MediaKeySession.remove()`](mediakeysession/remove)  
Returns a [`Promise`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) after removing any session data associated with the current object.

[`MediaKeySession.update()`](mediakeysession/update)  
Returns a [`Promise`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) after loading messages and licenses to the CDM.

Examples
--------

    // TBD

Specifications
--------------

<table><thead><tr class="header"><th>Specification</th><th>Status</th><th>Comment</th></tr></thead><tbody><tr class="odd"><td><a href="https://w3c.github.io/encrypted-media/#mediakeysession-interface">Encrypted Media Extensions<br />
<span class="small">The definition of 'MediaKeySession' in that specification.</span></a></td><td><span class="spec-rec">Recommendation</span></td><td>Initial definition.</td></tr></tbody></table>

Browser compatibility
---------------------

Desktop

Mobile

Chrome

Edge

Firefox

Internet Explorer

Opera

Safari

WebView Android

Chrome Android

Firefox for Android

Opera Android

Safari on IOS

Samsung Internet

`MediaKeySession`

42

13

38

No

Yes

12.1

43

42

38

Yes

12.2

4.0

`close`

42

13

38

No

Yes

12.1

43

42

38

Yes

12.2

4.0

`closed`

42

13

38

No

Yes

12.1

43

42

38

Yes

12.2

4.0

`expiration`

42

13

38

No

Yes

12.1

43

42

38

Yes

12.2

4.0

`generateRequest`

42

13

38

No

Yes

12.1

43

42

38

Yes

12.2

4.0

`keyStatuses`

42

13

38

No

Yes

12.1

43

42

38

Yes

12.2

4.0

`load`

42

13

38

No

Yes

12.1

43

42

38

Yes

12.2

4.0

`onkeystatuseschange`

55

79

52

No

42

12.1

43

55

52

42

12.2

6.0

`onmessage`

55

79

52

No

42

12.1

43

55

52

42

12.2

6.0

`remove`

42

13

38

No

Yes

12.1

43

42

38

Yes

12.2

4.0

`sessionId`

42

13

38

No

Yes

12.1

43

42

38

Yes

12.2

4.0

`update`

42

13

38

No

Yes

12.1

43

42

38

Yes

12.2

4.0

<a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaKeySession" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/MediaKeySession</a>
