<h1>EffectTiming.fill</h1>
<div class="notecard experimental"> <strong id="experimental">Experimental</strong> <p><strong>This is an <a href="https://developer.mozilla.org/en-US/docs/MDN/Guidelines/Conventions_definitions#experimental">experimental technology</a></strong><br>Check the <a href="#browser_compatibility">Browser compatibility table</a> carefully before using this in production.</p> </div> <p>The <a href="../web_animations_api">Web Animations API</a>'s <a href="../effecttiming"><code>EffectTiming</code></a> dictionary's <code>fill</code> property specifies a <strong>fill mode</strong>, which defines how the element to which the animation is applied should look when the animation sequence is not actively running, such as before the time specified by <a href="iterationstart"><code>iterationStart</code></a> or after animation's end time.</p> <p>For example, setting fill to <code>"none"</code> means the animation's effects are not applied to the element if the current time is outside the range of times during which the animation is running, while <code>"forwards"</code> ensures that once the animation's end time has been passed, the element will continue to be drawn in the state it was in at its last rendered frame.</p> <p>Note that authors are discouraged from using fill modes to persist the effect of an animation indefinitely. See the <a href="#alternatives_to_fill_modes">alternatives to fill modes section below</a> for approaches that are simpler and more performant.</p> <div class="note notecard"> <p><a href="../element/animate"><code>Element.animate()</code></a>, and <a href="../keyframeeffect/keyframeeffect"><code>KeyframeEffect()</code></a> accept an object of timing properties including <code>fill.</code> The value of <code>fill</code> corresponds directly to <a href="fill"><code>fill</code></a> in <a href="../effecttiming"><code>EffectTiming</code></a> objects returned by <a href="../animationeffect/gettiming"><code>getTiming()</code></a> in <a href="../animationeffect"><code>AnimationEffect</code></a> and <a href="../keyframeeffect"><code>KeyframeEffect</code></a>.</p> </div>
<h2 id="syntax">Syntax</h2>
<pre data-language="js"><span class="token keyword">var</span> timingProperties <span class="token operator">=</span> <span class="token punctuation">{</span>
  fill<span class="token operator">:</span> <span class="token string">"none"</span> <span class="token operator">|</span> <span class="token string">"forwards"</span> <span class="token operator">|</span> <span class="token string">"backwards"</span> <span class="token operator">|</span> <span class="token string">"both"</span> <span class="token operator">|</span> <span class="token string">"auto"</span>
<span class="token punctuation">}</span>
</pre>
<h3 id="value">Value</h3>
<p>A <a href="../domstring"><code>DOMString</code></a> indicating the fill type to use in order to properly render an affected element when outside the animation's <strong>active interval</strong> (that is, when it's not actively animating). The default is <code>"auto"</code>.</p> <dl> <dt><code>"none"</code></dt> <dd>The animation's effects are only visible while the animation is iterating or its playhead is positioned over an iteration. The animation's effects are not visible when its <a href="../animation/playstate"><code>playState</code></a> is <code>pending</code> with a <a class="page-not-created"><code>delay</code></a>, when its <code>playState</code> is <code>finished</code>, or during its <a class="page-not-created"><code>endDelay</code></a> or <a class="page-not-created"><code>delay</code></a>. In other words, if the animation isn't in its active interval, the affected element is not visible.</dd> <dt><code>"forwards"</code></dt> <dd>The affected element will continue to be rendered in the state of the final animation framecontinue to be applied to the after the animation has completed playing, in spite of and during any <a class="page-not-created"><code>endDelay</code></a> or when its <code>playState</code> is <code>finished</code>.</dd> <dt><code>"backwards"</code></dt> <dd>The animation's effects should be reflected by the element(s) state prior to playing, in spite of and during any <a class="page-not-created"><code>delay</code></a> and <code>pending</code> <a href="../animation/playstate"><code>playState</code></a>. </dd> <dt><code>"both"</code></dt> <dd>Combining the effects of <strong>both </strong><code>forwards</code> and <code>backwards</code>: The animation's effects should be reflected by the element(s) state prior to playing and retained after the animation has completed playing, in spite of and during any <a class="page-not-created"><code>endDelay</code></a>, <a class="page-not-created"><code>delay</code></a> and/or <code>pending</code> or <code>finished</code> <a href="../animation/playstate"><code>playState</code></a>.</dd> <dt><code>"auto"</code></dt> <dd>If the animation effect the fill mode is being applied to is a keyframe effect (<a href="../keyframeeffect"><code>KeyframeEffect</code></a> or <a href="../keyframeeffect"><code>KeyframeEffectReadOnly</code></a>), <code>"auto"</code> is equivalent to <code>"none"</code>. Otherwise, the result is <code>"both"</code>.</dd> </dl>
<h2 id="examples">Examples</h2>
<p>Here are a few examples.</p>
<h3 id="fill_mode_none">Fill mode: none</h3>
<h4 id="html_content">HTML content</h4> <p>The HTML is pretty simple. We have a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/div"><code>&lt;div&gt;</code></a> named <code>"main"</code> which is a container for the element we'll be animating, which is a <code>&lt;div&gt;</code> with the ID <code>"box"</code>. Below that, another <code>&lt;div&gt;</code> serves as a button that will trigger the animation to begin. </p> <pre data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>main<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Look! A box!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>animateButton<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  Animate!
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</pre> <p>While there's other CSS involved in this example, the part that really matters for our purposes is the CSS that styles the <code>"box"</code> element that we'll be animating. That CSS looks like this:</p> <pre data-language="css"><span class="token selector">#box</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #7788FF<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #2233FF<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre> <p>All this does is specify the size, border, and color information, as well as indicate that the box should be centered both vertically and horizontally inside its container. Note that there's no rotation applied.</p> <h4 id="javascript_content">JavaScript content</h4> <p>Now let's check out the JavaScript. First we'll define the two objects that describe the keyframes and the timing configuration to use, then we'll actually see the code that triggers and runs the animation when the <code>"animateButton"</code> button is clicked. </p> <pre class="notranslate">var boxRotationKeyframes = [
  { transform: "rotate(-90deg)" },
  { transform: "rotate(90deg)" }
];
</pre> <p>The <code>boxRotationKeyframes</code> object is an array of keyframes, each describing the state of the affected element at a point in the animation process. In this case, we have just two keyframes; the first defines what affect is applied to the element <em>immediately after the animation first begins to play</em>, and the second defines the effect applied to the element in the <em>last moment before it ends</em>. Those phrases are crucial. Let's look at why.</p> <p>The first keyframe says that when the animation begins, the element should be rotated 90° to the left. That means that unless we specify otherwise using the <code>fill</code> property, the instant the animation is started the element will be rotated to the left 90°, and then it will animate smoothly from there. Since by default the box isn't rotated,</p> <p>The last keyframe says that the animation's final frame should draw the animation rotated 90° to the right from its original orientation.</p> <pre data-language="js"><span class="token keyword">var</span> boxRotationTiming <span class="token operator">=</span> <span class="token punctuation">{</span>
  duration<span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
  iterations<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  fill<span class="token operator">:</span> <span class="token string">"none"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></pre> <p>The <code>boxRotationTiming</code> object describes how long the animation should take to run, how many times it should run, what state the element should be in before the animation begins and after it ends, and so forth.</p> <p>Here we specify that the animation should take 2000 milliseconds (2 seconds) to complete, should only run once, and that the fill mode should be <code>"none"</code>. As defined above, the <code>"none"</code> fill mode means that the element will be rendered in its natural, unaltered condition anytime the animation isn't actively running.</p> <pre data-language="js">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"animateButton"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"box"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span>
    boxRotationKeyframes<span class="token punctuation">,</span>
    boxRotationTiming
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre> <p>The rest of the code is pretty simple: it adds an event listener to the "Animate" button so that when it's clicked by the user, the box is animated by calling <a href="../element/animate"><code>Element.animate()</code></a> on it, providing the <code>boxRotationKeyframes</code> and <code>boxRotationTiming</code> objects to describe the animation that should occur. </p>
<h3 id="result">Result</h3>
<p>Below we see what the result looks like. Notice how before the animation starts running, the box is upright, then upon clicking the "Animate!" button, the box is instantly rotated 90° to the left (to correspond to the first keyframe in the animation sequence). Then, when the animation finishes running, the box instantaneously leaps back to its original state and is upright once again.</p> <p>Give it a try below!</p> <p><iframe class="sample-code-frame" id="frame_Fill_mode_none" width="320" height="320" src="https://yari-demos.prod.mdn.mozit.cloud/en-US/docs/Web/API/EffectTiming/fill/_samples_/Fill_mode_none" loading="lazy"></iframe></p>
<h3 id="follow_the_white_rabbit_example">Follow the White Rabbit example</h3>
<p>In the <a href="https://codepen.io/rachelnabors/pen/eJyWzm?editors=0010" rel=" noopener">Follow the White Rabbit</a> example, the White Rabbit's animation is formed by coupling a <code>KeyframeEffect</code> with an <code>Animation</code> object. The <code>keyframeEffect</code> takes an object of <a href="../effecttiming">timing properties</a>, which is where we pass in <code>fill</code>. <code>Forwards</code> makes the rabbit retain its last keyframe rather than reverting to its unanimated state: </p> <pre data-language="js"><span class="token comment">// Create a set of keyframes to slide the rabbit down the hole--and keep him down with 'fill'!</span>
<span class="token keyword">var</span> rabbitDownKeyframes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KeyframeEffect</span><span class="token punctuation">(</span>
  whiteRabbit<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> transform<span class="token operator">:</span> <span class="token string">'translateY(0%)'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> transform<span class="token operator">:</span> <span class="token string">'translateY(100%)'</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    duration<span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>
    fill<span class="token operator">:</span> <span class="token string">'forwards'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Set up the rabbit's animation to play on command by calling rabbitDownAnimation.play() later</span>
<span class="token keyword">var</span> rabbitDownAnimation <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animation</span><span class="token punctuation">(</span>rabbitDownKeyframes<span class="token punctuation">,</span> document<span class="token punctuation">.</span>timeline<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<h2 id="alternatives_to_fill_modes">Alternatives to fill modes</h2>
<p>Fill modes are primarily provided as a means of representing the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/animation-fill-mode">animation-fill-mode</a> feature of CSS animations. When used to persist the effect of an animation indefinitely, however, they have a number of drawbacks:</p> <ul> <li>The forwards fill of an animation (or backwards fill if the animation is playing in reverse) will continue to override any changes to specified style indefinitely which can lead to confusing behavior. This is because animations take priority in the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Cascade#cascading_order">CSS cascade</a> over normal author styles.</li> <li>In order to avoid leaking memory when many filling animations overlap, the browser is required to remove overlapped animations which can lead to surprising results in some cases.</li> </ul> <p>Rather than using fill modes to persist an animation, it is often simpler to set the final value of the animation effect directly in specified style:</p> <pre data-language="js">elem<span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">{</span> transform<span class="token operator">:</span> <span class="token string">'translateY(100px)'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span>finished<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  elem<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token string">'translateY(100px)'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre> <p>Alternatively, it may be simpler still to set the final value in specified style before triggering the animation and then animate <em>from</em> the start value. This is the approach used in <a href="https://aerotwist.com/blog/flip-your-animations/" rel=" noopener">FLIP animation</a>.</p> <pre data-language="js">elem<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token string">'translateY(100px)'</span><span class="token punctuation">;</span>
elem<span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">{</span> transform<span class="token operator">:</span> <span class="token string">'none'</span><span class="token punctuation">,</span> offset<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre> <p>For some complex effects where animations layer on top of one another, it may be necessary to use a fill mode temporarily to capture the final value of an animation before canceling it.</p> <pre data-language="js">elem<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">evt</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> animation <span class="token operator">=</span> elem<span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span> transform<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>evt<span class="token punctuation">.</span>clientX<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>evt<span class="token punctuation">.</span>clientY<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px)</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> duration<span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span> fill<span class="token operator">:</span> <span class="token string">'forwards'</span> <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> animation<span class="token punctuation">.</span>finished<span class="token punctuation">;</span>
  <span class="token comment">// commitStyles will record the style up to and including `animation` and</span>
  <span class="token comment">// update elem’s specified style with the result.</span>
  animation<span class="token punctuation">.</span><span class="token function">commitStyles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  animation<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<h2 id="specifications">Specifications</h2>
<div class="_table"><table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a href="https://drafts.csswg.org/web-animations-1/#enumdef-fillmode" hreflang="en" rel=" noopener">Web Animations<br><small>The definition of 'fill' in that specification.</small></a></td> <td><span class="spec-wd">Working Draft</span></td> <td>Editor's draft.</td> </tr> </tbody> </table></div>
<h2 id="browser_compatibility">Browser compatibility</h2>
<table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="6">Desktop</th>
<th colspan="6">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
<th>WebView Android</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
</tr>
</thead>
<tbody><tr>
<th><code>fill</code></th>
<td class="bc-supports-yes"><div>52</div></td>
<td class="bc-supports-yes"><div>79</div></td>
<td class="bc-supports-yes"><div>63</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>Yes</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>52</div></td>
<td class="bc-supports-yes"><div>52</div></td>
<td class="bc-supports-yes"><div>63</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>6.0</div></td>
</tr></tbody>
</table>


<h2 id="see_also">See also</h2>
<ul> <li><a href="../web_animations_api">Web Animations API</a></li> <li>
<a href="../element/animate"><code>Element.animate()</code></a> and <a href="../keyframeeffect/keyframeeffect"><code>KeyframeEffect.KeyframeEffect()</code></a> both accept an object of timing properties including this one.</li> <li>The value of this property corresponds to the one in <a href="../effecttiming"><code>EffectTiming</code></a> as returned by <a href="../animationeffect/gettiming"><code>getTiming()</code></a> in <a href="../animationeffect"><code>AnimationEffect</code></a> and <a href="../keyframeeffect"><code>KeyframeEffect</code></a>.</li> <li> CSS's <code><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/animation-fill-mode">animation-fill-mode</a></code> </li> </ul>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/EffectTiming/fill" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/EffectTiming/fill</a>
  </p>
</div>
